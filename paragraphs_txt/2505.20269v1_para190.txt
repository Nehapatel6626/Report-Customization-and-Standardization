our adaptation of the encoding in [17].