The algorithm works as follows: