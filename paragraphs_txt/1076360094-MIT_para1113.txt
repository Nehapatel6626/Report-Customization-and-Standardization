the cost function. This is done in two steps.