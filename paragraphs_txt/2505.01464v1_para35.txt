such that each internal update is recursively defined as: